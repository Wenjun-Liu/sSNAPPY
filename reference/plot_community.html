<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualise the community structure in significantly perturbed gene-set network — plot_community • sSNAPPY</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Visualise the community structure in significantly perturbed gene-set network — plot_community"><meta property="og:description" content="Visualise the community structure in significantly perturbed gene-set network"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sSNAPPY</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sSNAPPY.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Wenjun-Liu/sSNAPPY" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualise the community structure in significantly perturbed gene-set network</h1>
    <small class="dont-index">Source: <a href="https://github.com/Wenjun-Liu/sSNAPPY/blob/HEAD/R/plot_community.R" class="external-link"><code>R/plot_community.R</code></a></small>
    <div class="hidden name"><code>plot_community.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Visualise the community structure in significantly perturbed gene-set network</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_community</span><span class="op">(</span></span>
<span>  <span class="va">normalisedScores</span>,</span>
<span>  <span class="va">gsTopology</span>,</span>
<span>  gsAnnotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colorBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"robustZ"</span>, <span class="st">"pvalue"</span>, <span class="st">"community"</span><span class="op">)</span>,</span>
<span>  communityMethod <span class="op">=</span> <span class="st">"cluster_louvain"</span>,</span>
<span>  foldGSname <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  foldafter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"fr"</span>,</span>
<span>  markCommunity <span class="op">=</span> <span class="st">"ellipse"</span>,</span>
<span>  markAlpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  edgeAlpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  up_col <span class="op">=</span> <span class="st">"brown3"</span>,</span>
<span>  down_col <span class="op">=</span> <span class="st">"steelblue3"</span>,</span>
<span>  scale_edgeWidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  edgeLegend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale_nodeSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  nodeShape <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  color_lg_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lb_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  lb_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  plotIsolated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>normalisedScores</dt>
<dd><p>A <code>data.frame</code> derived from the <code><a href="normalise_by_permu.html">normalise_by_permu()</a></code> function</p></dd>


<dt>gsTopology</dt>
<dd><p>List of pathway topology matrices generated using function <code><a href="retrieve_topology.html">retrieve_topology()</a></code></p></dd>


<dt>gsAnnotation</dt>
<dd><p>A <code>data.frame</code> containing gene-sets categorisations for pathway annotation. Must contain at least two columns:
<code>c("gs_name", "category")</code>, where <code>gs_name</code> denotes gene-sets names that are matched to names of pathway topology matrices, and
<code>category</code> records the categorization of each pathway. If customized annotation is not provided, it's assumed that the pathways
investigated were from the KEGG database and the inbuilt KEGG pathway annotation information will be used</p></dd>


<dt>colorBy</dt>
<dd><p>Choose to color nodes either by <em>community</em>, <em>robustZ</em> or <em>pvalue</em>. To color by <em>robustZ</em> or <em>pvalue</em>, a
column must exist in the <code>normalisedScores</code> <code>data.frame</code> for the chosen parameter</p></dd>


<dt>communityMethod</dt>
<dd><p>A community detection method supported by <code>igraph</code>. See details for all methods available.</p></dd>


<dt>foldGSname</dt>
<dd><p><code>logical</code>. Should long gene-set names be folded into two lines</p></dd>


<dt>foldafter</dt>
<dd><p>The number of words after which gene-set names should be folded. Defaulted to 2</p></dd>


<dt>layout</dt>
<dd><p>The layout algorithm to apply. Accepted layouts are <code>"fr", "dh", "gem", "graphopt", "kk", "lgl", "mds" and "sugiyama"</code></p></dd>


<dt>markCommunity</dt>
<dd><p><code>character</code> A <code>geom_mark_*</code> method supported by <code>ggforce</code> to annotate sets of nodes belonging to the same community.
Either <code>*NULL*, *ellipse*, *circle*, *hull*, *rect*</code></p></dd>


<dt>markAlpha</dt>
<dd><p>Transparency of annotation areas. Default to 0.2</p></dd>


<dt>edgeAlpha</dt>
<dd><p>Transparency of edges. Default to 0.8</p></dd>


<dt>up_col</dt>
<dd><p>The color used to label activated gene-sets. Only applicable if <code>colorBy</code> is set to be "robustZ"</p></dd>


<dt>down_col</dt>
<dd><p>The color used to label inhibited gene-sets. Only applicable if <code>colorBy</code> is set to be "robustZ"</p></dd>


<dt>scale_edgeWidth</dt>
<dd><p>A numerical vector of length 2 to be provided to <code><a href="https://ggraph.data-imaginist.com/reference/scale_edge_width.html" class="external-link">ggraph::scale_edge_width_continuous()</a></code> for specifying
the minimum and maximum edge widths after transformation. Defaulted to c(0.5, 3)</p></dd>


<dt>edgeLegend</dt>
<dd><p><code>logical</code> Should edge weight legend be shown</p></dd>


<dt>scale_nodeSize</dt>
<dd><p>A numerical vector of length 2 to be provided to <code><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">ggplot2::scale_size()</a></code> for specifying
the minimum and maximum node sizes after transformation. Defaulted to c(3,6)</p></dd>


<dt>nodeShape</dt>
<dd><p>The shape to use for nodes</p></dd>


<dt>color_lg_title</dt>
<dd><p>Title for the color legend</p></dd>


<dt>lb_size</dt>
<dd><p>Size of node text labels</p></dd>


<dt>lb_color</dt>
<dd><p>Color of node text labels</p></dd>


<dt>plotIsolated</dt>
<dd><p><code>logical</code>.Should nodes not connected to any other nodes be plotted.  Default to FALSE</p></dd>


<dt>...</dt>
<dd><p>Used to pass various potting parameters to <code>ggforce::geom_mark_*()</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A ggplot2 object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>A community detection strategy specified by <code>communityMethod</code> will be applied to the pathway-pathway network,
and communities will be annotated with the pathway category that had the highest number of occurrence, denoting the
main biological processes perturbed in that community.</p>
<p>At the moment, only categorisations of KEGG pathway were built into the package, so if the provided <code>normalisedScores</code> contains perturbation
scores of pathways derived from other databases, annotation of communities will not be performed unless pathway information is provided through
the <code>gsAnnotation</code> parameter. The categorisation information needs to be stored in a <code>data.frame</code> containing <code>gs_name</code> (gene-set names) and
<code>category</code> (categorisation of the given pathways).</p>
<p>Plotting parameters accepted by <code>geom_mark_*</code> could be passed to the function to adjust the annotation area or the annotation
label. See <code>?ggforce::geom_mark_*</code> for more details.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"gsTopology.rda"</span>, package <span class="op">=</span> <span class="st">"sSNAPPY"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"normalisedScores.rda"</span>, package <span class="op">=</span> <span class="st">"sSNAPPY"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Subset the first 10 rows of the normalisedScores data.frame as an example</span></span></span>
<span class="r-in"><span><span class="va">subset</span> <span class="op">&lt;-</span> <span class="va">normalisedScores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Color network plot nodes by the community they were assigned to and mark nodes belonging</span></span></span>
<span class="r-in"><span><span class="co"># to the same community by ellipses</span></span></span>
<span class="r-in"><span><span class="fu">plot_community</span><span class="op">(</span><span class="va">subset</span>, <span class="va">gsTopology</span>, colorBy <span class="op">=</span> <span class="st">"community"</span>,layout <span class="op">=</span> <span class="st">"kk"</span>,</span></span>
<span class="r-in"><span>color_lg_title <span class="op">=</span> <span class="st">"Community"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_community-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Color network plot nodes by pathways' directions of changes and mark nodes belonging</span></span></span>
<span class="r-in"><span><span class="co"># to the same community by ellipses</span></span></span>
<span class="r-in"><span><span class="fu">plot_community</span><span class="op">(</span><span class="va">subset</span>, <span class="va">gsTopology</span>, colorBy <span class="op">=</span> <span class="st">"robustZ"</span>,layout <span class="op">=</span> <span class="st">"kk"</span>,</span></span>
<span class="r-in"><span>color_lg_title <span class="op">=</span> <span class="st">"Direction of pathway perturbation"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_community-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To change the colour and fill of `geom_mark_*` annotation, use any</span></span></span>
<span class="r-in"><span><span class="co"># `scale_fill_*` and/or `scale_color_*`</span></span></span>
<span class="r-in"><span><span class="co"># functions supported by `ggplot2`. For example:</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plot_community</span><span class="op">(</span><span class="va">subset</span>, <span class="va">gsTopology</span>, colorBy <span class="op">=</span> <span class="st">"robustZ"</span>,layout <span class="op">=</span> <span class="st">"kk"</span>,</span></span>
<span class="r-in"><span>markCommunity <span class="op">=</span> <span class="st">"rect"</span>,color_lg_title <span class="op">=</span> <span class="st">"Direction of pathway perturbation"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_ordinal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_ordinal</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_community-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/Wenjun-Liu" class="external-link">Wenjun Liu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

