<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute Single Sample Perturbation Score — computePerturbationScore • sSNAPPY</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Single Sample Perturbation Score — computePerturbationScore"><meta property="og:description" content="Propagate weighted single sample logFCs down the pathway topologies to compute single sample perturbation scores for each pathway"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sSNAPPY</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sSNAPPY.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Wenjun-Liu/sSNAPPY" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Single Sample Perturbation Score</h1>
    <small class="dont-index">Source: <a href="https://github.com/Wenjun-Liu/sSNAPPY/blob/HEAD/R/pertubationScore.R" class="external-link"><code>R/pertubationScore.R</code></a></small>
    <div class="hidden name"><code>computePerturbationScore.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Propagate weighted single sample logFCs down the pathway topologies to compute single sample perturbation scores for each pathway</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">computePerturbationScore</span><span class="op">(</span><span class="va">weightedFC</span>, <span class="va">gsTopology</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>weightedFC</dt>
<dd><p>A matrix of weighted single sample logFCs derived from function <code><a href="weight_ss_fc.html">weight_ss_fc()</a></code></p></dd>
<dt>gsTopology</dt>
<dd><p>List of pathway topology matrices generated using function <code><a href="retrieve_topology.html">retrieve_topology()</a></code></p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list where each element is a matrix corresponding to a pathway. Each column of an element corresponds to a sample.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function use the algorithm adopted from <code>SPIA</code> (see citation) to compute a single sample perturbation score per sample per
pathway. The rownames of the weighted single sample logFC matrix and the pathway topology matrices must use the same type of gene identifier (ie. entrez ID).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Tarca AL, Draghici S, Khatri P, Hassan SS, Mittal P, Kim JS, Kim CJ, Kusanovic JP, Romero R. A novel signaling pathway impact analysis.
Bioinformatics. 2009 Jan 1;25(1):75-82.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#compute weighted single sample logFCs</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metadata_example</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">logCPM_example</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="weight_ss_fc.html">weight_ss_fc</a></span><span class="op">(</span><span class="va">logCPM_example</span>, metadata <span class="op">=</span> <span class="va">metadata_example</span>,</span>
<span class="r-in">factor <span class="op">=</span> <span class="st">"patient"</span>, control <span class="op">=</span> <span class="st">"Vehicle"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># explore all databases supported by graphite</span></span>
<span class="r-in"><span class="fu">graphite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graphite/man/pathwayDatabases.html" class="external-link">pathwayDatabases</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          species     database</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      athaliana         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      athaliana     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      athaliana wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        btaurus         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        btaurus     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        btaurus     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        btaurus wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       celegans         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       celegans     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      celegans     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      celegans wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   cfamiliaris         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   cfamiliaris     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   cfamiliaris wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 dmelanogaster         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 dmelanogaster     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 dmelanogaster     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 dmelanogaster wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19        drerio         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20        drerio     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21        drerio wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         ecoli         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         ecoli     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         ecoli wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25       ggallus         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26       ggallus     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27       ggallus wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28      hsapiens         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29      hsapiens      panther</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30      hsapiens     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31      hsapiens     pharmgkb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32      hsapiens     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33      hsapiens        smpdb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34      hsapiens wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     mmusculus         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     mmusculus     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     mmusculus     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     mmusculus wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   rnorvegicus         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40   rnorvegicus     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   rnorvegicus     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   rnorvegicus wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   scerevisiae         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   scerevisiae     pathbank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   scerevisiae     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   scerevisiae wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47       sscrofa         kegg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48       sscrofa     reactome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49       sscrofa wikipathways</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50       xlaevis         kegg</span>
<span class="r-in"><span class="va">gsTopology</span> <span class="op">&lt;-</span> <span class="fu"><a href="retrieve_topology.html">retrieve_topology</a></span><span class="op">(</span>database <span class="op">=</span> <span class="st">"kegg"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ssPertScore</span> <span class="op">&lt;-</span> <span class="fu">computePerturbationScore</span><span class="op">(</span><span class="va">ls</span><span class="op">$</span><span class="va">logFC</span>, <span class="va">gsTopology</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/Wenjun-Liu" class="external-link">Wenjun
Liu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

