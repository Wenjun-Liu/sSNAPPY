<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute weighted single sample LogFCs from normalised logCPM — weight_ss_fc • sSNAPPY</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute weighted single sample LogFCs from normalised logCPM — weight_ss_fc"><meta property="og:description" content="Compute weighted single sample logFCs for each treated samples
using normalised logCPM values. Fit a lowess curve on variances of single
sample logFCs ~ mean of logCPM, and use it to predict a gene-wise weight.
The weighted single sample logFCs are ready to be used for computing
perturbation scores."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sSNAPPY</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sSNAPPY.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Wenjun-Liu/sSNAPPY" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute weighted single sample LogFCs from normalised logCPM</h1>
    <small class="dont-index">Source: <a href="https://github.com/Wenjun-Liu/sSNAPPY/blob/HEAD/R/compute_ssFC.R" class="external-link"><code>R/compute_ssFC.R</code></a></small>
    <div class="hidden name"><code>weight_ss_fc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute weighted single sample logFCs for each treated samples
using normalised logCPM values. Fit a lowess curve on variances of single
sample logFCs ~ mean of logCPM, and use it to predict a gene-wise weight.
The weighted single sample logFCs are ready to be used for computing
perturbation scores.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">weight_ss_fc</span><span class="op">(</span><span class="va">expreMatrix</span>, metadata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">factor</span>, <span class="va">control</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for matrix</span></span>
<span><span class="fu">weight_ss_fc</span><span class="op">(</span><span class="va">expreMatrix</span>, metadata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">factor</span>, <span class="va">control</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frame</span></span>
<span><span class="fu">weight_ss_fc</span><span class="op">(</span><span class="va">expreMatrix</span>, metadata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">factor</span>, <span class="va">control</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DGEList</span></span>
<span><span class="fu">weight_ss_fc</span><span class="op">(</span><span class="va">expreMatrix</span>, metadata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">factor</span>, <span class="va">control</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SummarizedExperiment</span></span>
<span><span class="fu">weight_ss_fc</span><span class="op">(</span><span class="va">expreMatrix</span>, metadata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">factor</span>, <span class="va">control</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>expreMatrix</dt>
<dd><p><code>matrix</code> and <code>data.frame</code> of logCPM, or <code>DGEList</code>/<code>SummarizedExperiment</code>
storing gene expression counts and sample metadata. Feature names need to be in entrez IDs,
and column names need to be sample names</p></dd>


<dt>metadata</dt>
<dd><p>Sample metadata <code>data.frame</code> as described in the details section.</p></dd>


<dt>factor</dt>
<dd><p><code>character</code> Factor defines how samples can be put into matching pairs (eg. patient).</p></dd>


<dt>control</dt>
<dd><p><code>character</code> Treatment level that is the control.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with two elements:
$weight  gene-wise weights;
$logFC weighted single sample logFC matrix</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function computes weighted single-sample logFCs from normalised logCPM
values, used for computing single-sample perturbation scores.</p>
<p>Since genes with smaller logCPM turn to have larger variances among single
sample logFCs.A lowess curve will be fitted to estimate the relationship
between variances of single-sample logFCs and mean of logCPM, and the relationship
will be used to estimate the variance of each mean logCPM value. Gene-wise weights,
which are inverse of variances, will then be multiplied to single-sample logFCs to
down-weight genes with low counts.</p>
<p>It is assumed that the genes with extremely low counts have been removed and the
count matrix has been normalised prior to the logCPM matrix was derived. Row names
of the matrix must be genes' entrez IDs.</p>
<p>If a S4 object of <code>DGEList or SummarizedExperiment</code> is provided as input
to <code>expreMatrix</code>, the gene expression matrix will be extracted from it and converted
to a logCPM matrix. Sample metadata will also be extracted from the same S4 object
unless otherwise specified.</p>
<p>Provided sample metadata should have the same number of rows as the number of columns
in the logCPM matrix. Metadata also must have a column called "sample" storing
sample names (column names of logCPM matrix), and a column called "treatment"
storing treatment of each sample.The control treatment level specified by the <code>control</code>
parameter must exist in the treatment column.</p>
<p>This analysis was designed for experimental designs involving matched pairs of
samples, such as when tissues collected from the same patient were treated with
different treatments to study different treatment effects. Parameter <code>factor</code> tells
the function how samples can be put into matching pairs. It must also be included as
a column in the metadata.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Inspect metadata data frame to make sure it has treatment, sample and patient columns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metadata_example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">logCPM_example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">logCPM_example</span><span class="op">)</span>, <span class="va">metadata_example</span><span class="op">$</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu">weight_ss_fc</span><span class="op">(</span><span class="va">logCPM_example</span>, metadata <span class="op">=</span> <span class="va">metadata_example</span>,</span></span>
<span class="r-in"><span> factor <span class="op">=</span> <span class="st">"patient"</span>, control <span class="op">=</span> <span class="st">"Vehicle"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/Wenjun-Liu" class="external-link">Wenjun Liu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

