"0","fit <- normalisedScores %>%"
"0","    left_join(metadata_example) %>%"
"0","    split(f = .$gs_name) %>%"
"0","    lapply(function(x)lm(robustZ ~ 0 + treatment, data = x)) %>%"
"0","    lapply(summary)"
"2","Joining with `by = join_by(sample)`"
"0","treat_sig <- lapply("
"0","  names(fit), "
"0","  function(x){"
"0","    fit[[x]]$coefficients %>%"
"0","      as.data.frame() %>%"
"0","      .[seq_len(2),] %>%"
"0","      dplyr::select(Estimate, pvalue = `Pr(>|t|)` ) %>%"
"0","      rownames_to_column(""Treatment"") %>%"
"0","      mutate("
"0","        gs_name = x, "
"0","        FDR = p.adjust(pvalue, ""fdr""), "
"0","        Treatment = str_remove_all(Treatment, ""treatment"")"
"0","      ) "
"0","  }) %>%"
"0","  bind_rows() "
