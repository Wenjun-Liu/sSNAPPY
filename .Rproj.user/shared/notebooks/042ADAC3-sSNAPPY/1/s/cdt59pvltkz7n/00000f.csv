"0","perSample_FC <- sapply(unique(metadata_example$patient), function(x){"
"0","   temp <- logCPM_example[1:1000,str_detect(colnames(logCPM_example), x)] "
"0","   ratio <- temp[, str_detect(colnames(temp), ""E2"")] - temp[, str_detect(colnames(temp), ""Vehicle"")] "
"0","   ratio %>%"
"0","     enframe(name = ""gene_id"", "
"0","             value = x)"
"0","}, simplify = FALSE) %>%"
"0","    Reduce(left_join,.)"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"0","aveCPM <- logCPM_example[1:1000,] %>%"
"0","  rowMeans() %>%"
"0","  enframe(name = ""gene_id"", "
"0","          value = ""aveCPM"")"
"0","p1 <- perSample_FC %>%"
"0","  pivot_longer(cols = -gene_id,"
"0","               names_to = ""name"","
"0","               values_to = ""logFC"") %>%"
"0","  left_join(aveCPM) %>%"
"0","  ggplot(aes(aveCPM, logFC)) +"
"0","  geom_point() +"
"0","  labs(y = ""sslogFC"", "
"0","       x = ""Average logCPM"") +"
"0","  theme("
"0","      panel.background = element_blank()"
"0","  )"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"0","p2 <- data.frame("
"0","  gene_id = perSample_FC$gene_id,"
"0","  variance = perSample_FC[,-1] %>%"
"0","    apply(1,var)) %>%"
"0","  left_join(aveCPM) %>%"
"0","  ggplot(aes(aveCPM, variance)) +"
"0","  geom_point() +"
"0","  geom_smooth(method = ""loess"") +"
"0","  labs(y = ""Variance in ssLogFCs"", "
"0","       x = ""Average logCPM"") +"
"0","  theme("
"0","      panel.background = element_blank()"
"0","  )"
"1","[38;5;232mJoining, by = ""gene_id""[39m
"
"0","plot_grid(p1, "
"0","          p2)"
"2","`geom_smooth()` using formula 'y ~ x'
"
